<!DOCTYPE html>
<html lang="zh">
<head>

        <title>Spring笔记01-构建应用</title>
        <meta charset="utf-8" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Liu Lixiang的博客 Full Atom Feed" />
        <link href="/feeds/java.atom.xml" type="application/atom+xml" rel="alternate" title="Liu Lixiang的博客 Categories Atom Feed" />


        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" type="text/css" href="./theme/gumby.css" />
        <link rel="stylesheet" type="text/css" href="./theme/style.css" />
        <link rel="stylesheet" type="text/css" href="./theme/pygment.css" />

        <script src="./theme/js/libs/modernizr-2.6.2.min.js"></script>




</head>

<body id="index" class="home">


    <div class="container">

        <div class="row">

          <header id="banner" class="body">
                  <h1><a href="./">Liu Lixiang的博客 <small>数据科学/Python/Java</small></a></h1>
          </header><!-- /#banner -->

            <div id="navigation" class="navbar row">
              <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>
             
              <ul class="columns">
                <li><a href="./">首页</a></li>

                <li><a href="/categories.html">分类</a></li>
                <li><a href="/tags.html">标签</a></li>
                <li><a href="/archives.html">归档</a></li>
                <li><a href="./pages/guan-yu.html">关于</a></li>

              </ul>
            </div>

<section id="content" class="body">

   <div class="row">
        <div class="eleven columns">


            <header>
              <h2 class="entry-title">
                <a href="./springbi-ji-01-gou-jian-ying-yong.html" rel="bookmark"
                   title="Permalink to Spring笔记01-构建应用">Spring笔记01-构建应用</a></h2>
           
            </header>
            <footer class="post-info">
              <abbr class="published" title="2016-08-10">
                三 10 八月 2016
              </abbr>
              <address class="vcard author">By 
                <a class="url fn" href="./author/liu-li-xiang.html"> 刘理想</a>
              </address>
            </footer><!-- /.post-info -->
            <div class="entry-content">
                <div class="toc">
<ul>
<li><a href="#11-springjava">1.1 一个Spring的简单Java应用</a><ul>
<li><a href="#111">1.1.1 创建应用</a></li>
<li><a href="#112-entity">1.1.2 定义entity</a></li>
<li><a href="#113-java">1.1.3 使用Java注解来进行调用</a></li>
<li><a href="#114">1.1.4 运行应用</a></li>
</ul>
</li>
<li><a href="#12-java">1.2 基于Java的配置</a><ul>
<li><a href="#121-configuration">1.2.1 @Configuration注解</a></li>
<li><a href="#122-importimportresource">1.2.2 @Import和@ImportResource注解</a></li>
</ul>
</li>
<li><a href="#13">1.3 基于注解的配置</a><ul>
<li><a href="#131-autowired">1.3.1 @Autowired注解</a></li>
<li><a href="#132-componentscancomponent-qualifier">1.3.2 @ComponentScan,@Component 以及@Qualifier注解</a></li>
<li><a href="#133-resource">1.3.3 @Resource注解</a></li>
</ul>
</li>
<li><a href="#14-xml">1.4 基于XML的配置</a><ul>
<li><a href="#141-xml">1.4.1 XML配置声明</a></li>
<li><a href="#142-xml">1.4.2 加载XML配置</a></li>
<li><a href="#143-xmlbean">1.4.3 在XML配置中使用Bean扫描</a></li>
</ul>
</li>
</ul>
</div>
              
<h2 id="11-springjava">1.1 一个Spring的简单Java应用</h2>
<h3 id="111">1.1.1 创建应用</h3>
<p>这里，我们用Gradle创建Spring的应用。</p>
<div class="highlight"><pre><span></span>group 'lx.spring.core'
version '1.0-SNAPSHOT'

apply plugin: 'java'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

dependencies {
    compile group: 'org.springframework', name: 'spring-context', version: '4.3.2.RELEASE'
    testCompile group: 'org.springframework', name: 'spring-test', version: '4.3.2.RELEASE'
    testCompile group: 'junit', name: 'junit', version: '4.11'
}
</pre></div>
<h3 id="112-entity">1.1.2 定义entity</h3>
<p>spring希望我们尽可能的使用接口，因此，我们声明，<code>Team</code>, <code>Game</code>接口，然后创建对应的实现：</p>
<div class="highlight"><pre><span></span>public interface Team {
    String getName();
}

public interface Game {
    void setHomeTeam(Team team);
    Team getHomeTeam();
    void setAwayTeam(Team team);
    Team getAwayTeam();
    String playGame();
}
</pre></div>
<p>对应的实现类：</p>
<div class="highlight"><pre><span></span>public class Cubs implements Team {
    @Override
    public String getName() {
        return "Chicago Cubs";
    }
}

public class RedSox implements Team {
    @Override
    public String getName() {
        return "Bostom Red Sox";
    }
}

public class Royals implements Team {
    @Override
    public String getName() {
        return "Kansas City Royals";
    }
}

public class BaseballGame implements Game {
    private Team homeTeam;
    private Team awayTeam;

    public BaseballGame() {
    }

    public BaseballGame(Team homeTeam, Team awayTeam) {
        this.homeTeam = homeTeam;
        this.awayTeam = awayTeam;
    }

    @Override
    public Team getHomeTeam() {
        return homeTeam;
    }

    @Override
    public void setHomeTeam(Team homeTeam) {
        this.homeTeam = homeTeam;
    }

    @Override
    public Team getAwayTeam() {
        return awayTeam;
    }

    @Override
    public void setAwayTeam(Team awayTeam) {
        this.awayTeam = awayTeam;
    }

    @Override
    public String playGame() {
        return Math.random() &lt; 0.5 ? getHomeTeam().getName() :
                getAwayTeam().getName();
    }
}
</pre></div>
<h3 id="113-java">1.1.3 使用Java注解来进行调用</h3>
<p>为了让我们的应用能够使用定义的entity，我们需要做配置，配置的方法多种多样，我们这里使用Java对象进行配置，创建一个配置类<code>AppConfig</code>:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Bean</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="p">;</span>

<span class="nd">@Configuration</span>
<span class="n">public</span> <span class="k">class</span> <span class="nc">AppConfig</span> <span class="p">{</span>
    <span class="nd">@Bean</span>
    <span class="n">public</span> <span class="n">Game</span> <span class="n">game</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">new</span> <span class="n">BaseballGame</span><span class="p">(</span><span class="n">redSox</span><span class="p">(),</span> <span class="n">cubs</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="nd">@Bean</span>
    <span class="n">public</span> <span class="n">Team</span> <span class="n">redSox</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">new</span> <span class="n">RedSox</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@Bean</span>
    <span class="n">public</span> <span class="n">Team</span> <span class="n">cubs</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">new</span> <span class="n">Cubs</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>注意这里的<code>game()</code>方法中调用了<code>redSox()</code>和<code>cubs()</code>方法，后面我们会进行讲解。</p>
<h3 id="114">1.1.4 运行应用</h3>
<p>现在有了bean和对应的config，我们可以对他们进行调用了。</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lx.spring.core.entities.Game</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.ApplicationContext</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.AnnotationConfigApplicationContext</span><span class="p">;</span>

<span class="n">public</span> <span class="k">class</span> <span class="nc">RunDemo</span> <span class="p">{</span>
    <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="n">new</span> <span class="n">AnnotationConfigApplicationContext</span><span class="p">(</span><span class="n">AppConfig</span><span class="o">.</span><span class="n">class</span><span class="p">);</span>

        <span class="n">Game</span> <span class="n">game</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">getBean</span><span class="p">(</span><span class="s2">"game"</span><span class="p">,</span> <span class="n">Game</span><span class="o">.</span><span class="n">class</span><span class="p">);</span>
        <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="n">game</span><span class="o">.</span><span class="n">playGame</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>由此可见Spring隐藏了细节，让代码变得简单。</p>
<h2 id="12-java">1.2 基于Java的配置</h2>
<p>基于Java的配置是目前Spring应用的推荐做法。之前有做法是基于XML进行配置的。</p>
<p>为什么现在推荐用java进行配置呢？</p>
<p>因为这样做能让配置集中，有时候一个java文件就能包含所有配置了。其次，能让IDE进行错误提示。最后，可以利用Java语言的强大功能做一些其他工作。</p>
<p>使用Java进行配置的缺点是你要记住你的源码中有一些是既不属于业务，也不属于repository，而只是配置文件。</p>
<p>我们来看看之前的注解。文档在http://docs.spring.io/spring/docs/current/javadoc-api/ </p>
<h3 id="121-configuration">1.2.1 <code>@Configuration</code>注解</h3>
<p>文档中关于<code>@Cofiguration</code>注解内容如下：</p>
<div class="highlight"><pre><span></span>@Target(value=TYPE)
 @Retention(value=RUNTIME)
 @Documented
 @Component
public @interface Configuration
</pre></div>
<blockquote>
<p>Indicates that a class declares one or more @Bean methods and may be processed by the Spring container to generate bean definitions and service requests for those beans at runtime, for example:</p>
</blockquote>
<div class="highlight"><pre><span></span>@Configuration
public class AppConfig {
     @Bean
     public MyBean myBean() {
         // instantiate, configure and return bean ...
     }
 }
</pre></div>
<p>对于上面的<code>public MyBean myBean()</code>方法，在XML中<code>myBean</code>对应ID（每个Bean都有一个唯一的ID），<code>MyBean</code>则对应XML中的类型。也就是说我们有一个叫做<code>myBean</code>的Bean，类型是<code>MyBean</code>。</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Bean</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="p">;</span>

<span class="nd">@Configuration</span>
<span class="n">public</span> <span class="k">class</span> <span class="nc">AppConfig</span> <span class="p">{</span>
    <span class="nd">@Bean</span>
    <span class="n">public</span> <span class="n">Game</span> <span class="n">game</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">new</span> <span class="n">BaseballGame</span><span class="p">(</span><span class="n">redSox</span><span class="p">(),</span> <span class="n">cubs</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="nd">@Bean</span>
    <span class="n">public</span> <span class="n">Team</span> <span class="n">redSox</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">new</span> <span class="n">RedSox</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@Bean</span>
    <span class="n">public</span> <span class="n">Team</span> <span class="n">cubs</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">new</span> <span class="n">Cubs</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>在我们的例子中，<code>game</code>这个Bean又调用了<code>redSox()</code>和<code>cubs()</code>，后面我们会详细解释Bean的范围。现在我们要知道一件事情就是，基本上，Spring会假设这些类都是单例的，也就是如果实例不存在，就实例化，然后放入Spring Context中，如果实例存在，就返回实例。</p>
<p>要启动一个Spring容器，我们使用：</p>
<div class="highlight"><pre><span></span>ApplicationContext context = 
    new AnnotationConfigApplicationContext(AppConfig.class);
</pre></div>
<p>除此之外，我们还可以从Context中获取其他信息：</p>
<div class="highlight"><pre><span></span>//获取Bean的数量
System.out.println("Bean的数量" + context.getBeanDefinitionCount());
//获取Bean的名称
for (String name :
        context.getBeanDefinitionNames()) {
    System.out.println(name );
}
</pre></div>
<p>我们的输出：</p>
<div class="highlight"><pre><span></span>Bean的数量12
org.springframework.context.annotation.internalConfigurationAnnotationProcessor
org.springframework.context.annotation.internalAutowiredAnnotationProcessor
org.springframework.context.annotation.internalRequiredAnnotationProcessor
org.springframework.context.annotation.internalCommonAnnotationProcessor
org.springframework.context.event.internalEventListenerProcessor
org.springframework.context.event.internalEventListenerFactory
appConfig
org.springframework.context.annotation.ConfigurationClassPostProcessor.importAwareProcessor
org.springframework.context.annotation.ConfigurationClassPostProcessor.enhancedConfigurationProcessor
redSox
cubs
game
</pre></div>
<p>我们可以看到，除了自己的Bean之外，还有一些其他的基础设施Bean，此外<code>appConfig</code>本身也是一个Bean.</p>
<h3 id="122-importimportresource">1.2.2 <code>@Import</code>和<code>@ImportResource</code>注解</h3>
<p>与<code>@Cofiguration</code>能一起用的还有:</p>
<ul>
<li><code>@Import</code> 可以从别的Config中导入配置</li>
<li><code>@ImportResource</code> 从非Java文件中导入配置，比如从XML文件中导入配置</li>
</ul>
<p>这些能够用于项目模块比较多的情况下。</p>
<p>现在，我们新建一个类<code>InfrastructureConfig</code>，一般来说基础设置配置的是数据库连接池、或者其他数据源等。 但是现在我们需要修改<code>build.gradle</code>来添加<code>spring-jdbc</code>依赖：</p>
<div class="highlight"><pre><span></span>compile group: 'org.springframework', name: 'spring-jdbc', version: '4.3.2.RELEASE'
</pre></div>
<p><code>InfrastructureConfig</code>内容如下：</p>
<div class="highlight"><pre><span></span><span class="n">package</span> <span class="n">lx</span><span class="o">.</span><span class="n">spring</span><span class="o">.</span><span class="n">core</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Bean</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.jdbc.datasource.DriverManagerDataSource</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.sql.DataSource</span><span class="p">;</span>

<span class="nd">@Configuration</span>
<span class="n">public</span> <span class="k">class</span> <span class="nc">InfrastructureConfig</span> <span class="p">{</span>
    <span class="nd">@Bean</span>
    <span class="n">public</span> <span class="n">DataSource</span> <span class="n">dataSource</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">new</span> <span class="n">DriverManagerDataSource</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>现在，我们可以在<code>AppConfig</code>中使用<code>InfrastructureConfig</code>了：</p>
<div class="highlight"><pre><span></span>@Configuration
@Import(InfrastructureConfig.class)
public class AppConfig {...}
</pre></div>
<p>现在假设我们的<code>BaseballGame</code>需要一个<code>DataSource</code>:</p>
<div class="highlight"><pre><span></span>public class BaseballGame implements Game {
    private DataSource dataSource;

    public void setDataSource(DataSource dataSource) {
        this.dataSource = dataSource;
    }
    //...
}    
</pre></div>
<p>现在，我们再修改<code>AppConfig</code>，让Bean自动配置<code>DataSource</code>:</p>
<div class="highlight"><pre><span></span>@Bean
public Game game(DataSource dataSource) {
    BaseballGame game = new BaseballGame(redSox(), cubs());
    game.setDataSource(dataSource);
    return game;
}
</pre></div>
<p>这里，我们给<code>game()</code>这个Bean添加了参数<code>DataSource</code>，Spring会自动根据参数来查找对应的Bean（这里这个Bean在<code>InfrastructureConfig</code>中），然后产生一个参数，来进行配置。</p>
<p>以上就是用Java进行配置的方法，下面我们用基于注解的配置。</p>
<h2 id="13">1.3 基于注解的配置</h2>
<p>这一节我们需要接触两个概念：<code>Autowired</code>、<code>ComponentScan</code>和<code>Component</code>。</p>
<h3 id="131-autowired">1.3.1 <code>@Autowired</code>注解</h3>
<p>我们再来看看之前关于<code>game</code>的例子：</p>
<div class="highlight"><pre><span></span>@Configuration
@Import(InfrastructureConfig.class)
public class AppConfig {
    @Bean
    public Game game(DataSource dataSource) {
        BaseballGame game = new BaseballGame(redSox(), cubs());
        game.setDataSource(dataSource);
        return game;
    }
    ...
}
</pre></div>
<p>这里，如果我们不知道<code>InfrastructureConfig</code>里的内容的话，<code>DataSouce</code>看起来有些奇怪，我们可以使用<code>Autowired</code>来寻找所有的Bean并且找到匹配的Bean:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="o">...</span>
<span class="n">public</span> <span class="k">class</span> <span class="nc">AppConfig</span> <span class="p">{</span>

    <span class="nd">@Autowired</span> <span class="o">//</span><span class="err">重点在这里</span>
    <span class="n">private</span> <span class="n">DataSource</span> <span class="n">dataSource</span><span class="p">;</span>
    <span class="nd">@Bean</span>
    <span class="n">public</span> <span class="n">Game</span> <span class="n">game</span><span class="p">()</span> <span class="p">{</span> <span class="o">//</span><span class="err">此处已经不需要参数了</span>
        <span class="n">BaseballGame</span> <span class="n">game</span> <span class="o">=</span> <span class="n">new</span> <span class="n">BaseballGame</span><span class="p">(</span><span class="n">redSox</span><span class="p">(),</span> <span class="n">cubs</span><span class="p">());</span>
        <span class="n">game</span><span class="o">.</span><span class="n">setDataSource</span><span class="p">(</span><span class="n">dataSource</span><span class="p">);</span> <span class="o">//</span><span class="err">直接引用</span>
        <span class="k">return</span> <span class="n">game</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="o">...</span>
<span class="p">}</span>    
</pre></div>
<p>注意：</p>
<ol>
<li><code>@Autowired</code>意味着自动按照<strong>类型</strong>触发，也就是<strong>只有一个</strong>这种<strong>类型</strong>的<strong>Bean</strong>时才起作用。</li>
<li><code>@Autowired</code>对Bean的声明形式没有要求，可以是XML, Java或者使用<code>@Component</code>等声明。</li>
</ol>
<p>我们之前系统里只有一个<code>DataSource</code>，所以这么做没问题，但是如果我们将这种方法用到<code>BaseballGame</code>身上，就会有问题。下面我们来看看如何解决这个问题。</p>
<h3 id="132-componentscancomponent-qualifier">1.3.2 <code>@ComponentScan</code>,<code>@Component</code> 以及<code>@Qualifier</code>注解</h3>
<p><code>@ComponentScan</code>会扫描当前文件夹及其子文件夹下，但是最好指定<code>basePackages</code>参数，告诉它从哪里开始扫描。 </p>
<p>现在我们再次修改<code>AppConfig</code>：</p>
<div class="highlight"><pre><span></span>@Configuration
@ComponentScan(basePackages = "lx.spring.core")
public class AppConfig {

    @Autowired
    private DataSource dataSource;

    @Autowired @Qualifier("redSox")
    private Team home;


    @Autowired @Qualifier("cubs")
    private Team away;

    @Bean
    public Game game() {
        BaseballGame game = new BaseballGame(home, away);
        game.setDataSource(dataSource);
        return game;
    }
}
</pre></div>
<p>注意这里的<code>@Qualifier</code>就是前面说的如果存在多个相同类型的Bean时，如何让<code>@Autowired</code>能正常工作的解决方法。</p>
<p>另外，我们还需要对<code>RedSox</code>和<code>Cubs</code>类添加<code>@Component</code>注解：</p>
<div class="highlight"><pre><span></span>@Component
public class RedSox implements Team {...}

@Component
public class Cubs implements Team {...}
</pre></div>
<p>使用注解声明的优点：我们不需要单独写Bean的配置，只需要声明就可以了。但这也有一些潜在的缺点：Bean可能散布在整个项目中，那我们需要大量的扫描，但是在现实中，我们一般会把Bean放到一个特殊的包中。一般来说，主要有下面几种常用的包：</p>
<ul>
<li>repositories</li>
<li>services</li>
<li>controllers</li>
</ul>
<p><strong>注意</strong>，扫描只在应用启动时进行一次，运行的时候是不会再扫描的。</p>
<h3 id="133-resource">1.3.3 <code>@Resource</code>注解</h3>
<p>Java提供了一个标准的注解<code>@Resource</code>，也是用来自动触发，但与Spring的<code>Autowired</code>不同，它不是按照类型，而是<strong>按照名字</strong>触发。 </p>
<p>下面的例子是就是Spring根据变量的名字去找对应的Bean.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.annotation.Resource</span><span class="p">;</span>
<span class="o">...</span>
<span class="n">public</span> <span class="k">class</span> <span class="nc">AppConfig</span> <span class="p">{</span>
    <span class="nd">@Resource</span>
    <span class="n">private</span> <span class="n">Team</span> <span class="n">redSox</span><span class="p">;</span>

    <span class="nd">@Resource</span>
    <span class="n">private</span> <span class="n">Team</span> <span class="n">cubs</span><span class="p">;</span>

    <span class="nd">@Bean</span>
    <span class="n">public</span> <span class="n">Game</span> <span class="n">game</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">BaseballGame</span> <span class="n">game</span> <span class="o">=</span> <span class="n">new</span> <span class="n">BaseballGame</span><span class="p">(</span><span class="n">redSox</span><span class="p">,</span> <span class="n">cubs</span><span class="p">);</span>
        <span class="o">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>但一般我们好少这么做，因为这样的话我们就没法改变量的名字了。</p>
<p>现在我们学习了使用Java配置、使用注解配置，接下来我们来看看使用XML进行配置，有点丑，但之前一直这么用，所以还是了解一下比较好。</p>
<h2 id="14-xml">1.4 基于XML的配置</h2>
<p>对于基于注解的配置，我们必须要有源码才行。对于基于Java的配置，则是有些库根本就不支持这样的做法。XML配置有时会提供一些比较简便的配置方法，因此我们最好还是了解一下。 </p>
<h3 id="141-xml">1.4.1 XML配置声明</h3>
<p>我们在<code>main/resources</code>下创建<code>applicationContext.xml</code>，注意，在IDEA中请用<code>new-&gt;XML Configuration File-&gt;Spring config</code>来新建。</p>
<p>为了方便，现在，我们先把<code>AppConfig</code>中的内容注释掉，把<code>RunDemo</code>的调用容器的也注释掉。</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"redSox"</span> <span class="na">class=</span><span class="s">"lx.spring.core.entities.RedSox"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"cubs"</span> <span class="na">class=</span><span class="s">"lx.spring.core.entities.Cubs"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"game"</span> <span class="na">class=</span><span class="s">"lx.spring.core.entities.BaseballGame"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"awayTeam"</span> <span class="na">ref=</span><span class="s">"redSox"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"homeTeam"</span> <span class="na">ref=</span><span class="s">"cubs"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"dataSource"</span> <span class="na">ref=</span><span class="s">"dataSource"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>

    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"dataSource"</span> <span class="na">class=</span><span class="s">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span><span class="nt">/&gt;</span>

<span class="nt">&lt;/beans&gt;</span>
</pre></div>
<p>Bean由3部分组成，<code>id</code>, <code>class</code>和<code>property</code>。注意<code>property</code>可以使用<code>ref</code>来引用其他的Bean，也可以使用<code>value</code>来指定值。</p>
<h3 id="142-xml">1.4.2 加载XML配置</h3>
<div class="highlight"><pre><span></span>ApplicationContext context = new ClassPathXmlApplicationContext("applicationContext.xml");
</pre></div>
<p><strong>注意</strong>，此时输出的Bean的数量只有4个（也就是XML中声明的数量）。</p>
<h3 id="143-xmlbean">1.4.3 在XML配置中使用Bean扫描</h3>
<p>我们要使用Bean扫描该怎么办呢？我们给XML添加命名空间就好了。</p>
<div class="highlight"><pre><span></span>&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/beans/spring-context.xsd"&gt;

    &lt;context:component-scan base-package="lx.spring.core"/&gt;
    ...
</pre></div>
<p>这个时候除了<code>DataSource</code>需要声明外，其他的Bean不需要再XML文件中声明，只需要像之前那样使用注解声明就可以了。</p>
            </div><!-- /.entry-content -->
        
 
            <section>
            <div id="DuoShuoComment" aria-live="polite">
<!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="springbi-ji-01-gou-jian-ying-yong.html" data-title="Spring笔记01-构建应用" data-url="./springbi-ji-01-gou-jian-ying-yong.html"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"liulixiang1988blog"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
<!-- 多说公共JS代码 end -->
            </div>
            </section> 

        </div><!-- /.eleven.columns -->

<div class="three columns">

<nav class="widget">
  <h4>社交</h4>
  <ul class="blank">
    <li><a href="https://www.zhihu.com/people/liulixiang1988">知乎</a></li>
    <li><a href="http://weibo.com/liulixiang1988">微博</a></li>
  </ul>
</nav>

<h4>分类</h4>
<ul class="blank">
		<li><a href="./category/android.html">Android</a></li>
		<li><a href="./category/database.html">Database</a></li>
		<li><a href="./category/dotnet.html">DotNet</a></li>
		<li><a href="./category/ionic.html">ionic</a></li>
		<li><a href="./category/java.html">Java</a></li>
		<li><a href="./category/python.html">Python</a></li>
		<li><a href="./category/sheng-huo.html">生活</a></li>
		<li><a href="./category/web.html">Web</a></li>
		<li><a href="./category/yi-dong-kai-fa.html">移动开发</a></li>
</ul>


<h4>标签</h4>
	<ul class="blank">
	    <li class="tag-[<pelican.contents.Article object at 0x1045030b8>, <pelican.contents.Article object at 0x10452e710>, <pelican.contents.Article object at 0x1044d3b70>, <pelican.contents.Article object at 0x105065128>, <pelican.contents.Article object at 0x104792a20>, <pelican.contents.Article object at 0x104fc1cf8>, <pelican.contents.Article object at 0x104fc1a58>, <pelican.contents.Article object at 0x10536cf98>, <pelican.contents.Article object at 0x1044d35f8>, <pelican.contents.Article object at 0x104534278>, <pelican.contents.Article object at 0x104514160>, <pelican.contents.Article object at 0x104514550>, <pelican.contents.Article object at 0x1044d0f60>, <pelican.contents.Article object at 0x103c4c198>]"><a href="./tag/androidxue-xi-bi-ji.html">Android学习笔记</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x10507a7f0>, <pelican.contents.Article object at 0x10471e6a0>, <pelican.contents.Article object at 0x10471c940>, <pelican.contents.Article object at 0x104577518>, <pelican.contents.Article object at 0x104b10f60>]"><a href="./tag/css3.html">CSS3</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x1045b1e48>, <pelican.contents.Article object at 0x104759be0>]"><a href="./tag/flask.html">Flask</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x104754c88>, <pelican.contents.Article object at 0x1047189e8>, <pelican.contents.Article object at 0x104805dd8>]"><a href="./tag/django.html">Django</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x10473f278>]"><a href="./tag/hibernate.html">Hibernate</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x1050a1be0>, <pelican.contents.Article object at 0x10505fda0>, <pelican.contents.Article object at 0x104b1d8d0>, <pelican.contents.Article object at 0x104792e10>, <pelican.contents.Article object at 0x104514d68>, <pelican.contents.Article object at 0x104b10128>, <pelican.contents.Article object at 0x104797400>, <pelican.contents.Article object at 0x1048bfe80>, <pelican.contents.Article object at 0x1047f3860>, <pelican.contents.Article object at 0x10503cdd8>, <pelican.contents.Article object at 0x10532b390>, <pelican.contents.Article object at 0x1054308d0>]"><a href="./tag/less.html">LESS</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x10471c940>, <pelican.contents.Article object at 0x104577518>, <pelican.contents.Article object at 0x104b10f60>]"><a href="./tag/compass.html">compass</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x1048f9470>]"><a href="./tag/gradle.html">Gradle</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x104bea978>]"><a href="./tag/net.html">.NET</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x1044d3b70>]"><a href="./tag/androiyue-hou-ji-fen.html">Androi阅后即焚</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x104b04860>]"><a href="./tag/mo-kuai-hua.html">模块化</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x1053e7f98>, <pelican.contents.Article object at 0x105390dd8>, <pelican.contents.Article object at 0x105061550>]"><a href="./tag/netty.html">Netty</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x1050a1be0>, <pelican.contents.Article object at 0x10505fda0>, <pelican.contents.Article object at 0x104b1d8d0>, <pelican.contents.Article object at 0x104792e10>, <pelican.contents.Article object at 0x104514d68>, <pelican.contents.Article object at 0x104b10128>, <pelican.contents.Article object at 0x104797400>, <pelican.contents.Article object at 0x1048bfe80>, <pelican.contents.Article object at 0x1047f3860>, <pelican.contents.Article object at 0x10503cdd8>, <pelican.contents.Article object at 0x10532b390>, <pelican.contents.Article object at 0x10502ccf8>]"><a href="./tag/html.html">HTML</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x103c17cc0>]"><a href="./tag/android-studio.html">Android Studio</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x1048f6898>]"><a href="./tag/phonegap.html">PhoneGap</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x105385400>, <pelican.contents.Article object at 0x10503f470>, <pelican.contents.Article object at 0x10503c9e8>, <pelican.contents.Article object at 0x104fc4cc0>, <pelican.contents.Article object at 0x104fe5198>, <pelican.contents.Article object at 0x10502c940>, <pelican.contents.Article object at 0x1050a1be0>, <pelican.contents.Article object at 0x10505fda0>, <pelican.contents.Article object at 0x104b1d8d0>, <pelican.contents.Article object at 0x104792e10>, <pelican.contents.Article object at 0x104514d68>, <pelican.contents.Article object at 0x104b10128>, <pelican.contents.Article object at 0x104797400>, <pelican.contents.Article object at 0x1048bfe80>, <pelican.contents.Article object at 0x1047f3860>, <pelican.contents.Article object at 0x10503cdd8>, <pelican.contents.Article object at 0x10532b390>, <pelican.contents.Article object at 0x10502ccf8>, <pelican.contents.Article object at 0x1054308d0>]"><a href="./tag/css.html">CSS</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x104bea978>]"><a href="./tag/c.html">C#</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x104bea978>]"><a href="./tag/nancy.html">Nancy</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x104759a58>]"><a href="./tag/gulp.html">Gulp</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x10472af28>]"><a href="./tag/exmobi.html">Exmobi</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x10471e128>]"><a href="./tag/functional-programming.html">Functional Programming</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x1048c1438>, <pelican.contents.Article object at 0x10474eef0>]"><a href="./tag/ionic.html">ionic</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x104743c50>, <pelican.contents.Article object at 0x10473fd68>, <pelican.contents.Article object at 0x10477fd30>, <pelican.contents.Article object at 0x1045aa8d0>, <pelican.contents.Article object at 0x104728e10>]"><a href="./tag/aspnet-mvc.html">ASP.NET MVC</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x10476da20>]"><a href="./tag/mysql.html">MySQL</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x104be2908>]"><a href="./tag/jquery.html">jQuery</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x10471c940>, <pelican.contents.Article object at 0x104577518>, <pelican.contents.Article object at 0x104b10f60>, <pelican.contents.Article object at 0x105385400>, <pelican.contents.Article object at 0x10503f470>, <pelican.contents.Article object at 0x10503c9e8>, <pelican.contents.Article object at 0x104fc4cc0>, <pelican.contents.Article object at 0x104fe5198>, <pelican.contents.Article object at 0x10502c940>]"><a href="./tag/sass.html">sass</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x104856b00>, <pelican.contents.Article object at 0x104b56f28>, <pelican.contents.Article object at 0x10476f400>, <pelican.contents.Article object at 0x104889d30>, <pelican.contents.Article object at 0x1048ff550>, <pelican.contents.Article object at 0x1048dbe80>, <pelican.contents.Article object at 0x1045357f0>, <pelican.contents.Article object at 0x10484b588>, <pelican.contents.Article object at 0x1048cf198>]"><a href="./tag/jsp.html">JSP</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x103c17d30>, <pelican.contents.Article object at 0x10472e710>, <pelican.contents.Article object at 0x1045b1dd8>]"><a href="./tag/life.html">life</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x1045b4400>, <pelican.contents.Article object at 0x1048bc0f0>, <pelican.contents.Article object at 0x1045a5f98>, <pelican.contents.Article object at 0x10476f8d0>]"><a href="./tag/shu-ju-fen-xi.html">数据分析</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x10543b048>, <pelican.contents.Article object at 0x10543b198>, <pelican.contents.Article object at 0x105023c88>, <pelican.contents.Article object at 0x105025390>, <pelican.contents.Article object at 0x104d617f0>, <pelican.contents.Article object at 0x1050a5208>, <pelican.contents.Article object at 0x10543ba20>]"><a href="./tag/react.html">React</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x10485bf98>, <pelican.contents.Article object at 0x104b0b710>]"><a href="./tag/servlet.html">Servlet</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x104754c88>]"><a href="./tag/bu-shu.html">部署</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x105384240>, <pelican.contents.Article object at 0x104beadd8>]"><a href="./tag/xue-xi-bi-ji.html">学习笔记</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x10507a048>, <pelican.contents.Article object at 0x104d62a58>, <pelican.contents.Article object at 0x10456e7b8>]"><a href="./tag/spring.html">Spring</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x104743c50>, <pelican.contents.Article object at 0x10473fd68>, <pelican.contents.Article object at 0x10477fd30>, <pelican.contents.Article object at 0x1045aa8d0>, <pelican.contents.Article object at 0x104728e10>]"><a href="./tag/dotnet.html">DotNet</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x104704470>, <pelican.contents.Article object at 0x1045b1dd8>]"><a href="./tag/pelican.html">Pelican</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x104759be0>]"><a href="./tag/flaskbi-ji.html">Flask笔记</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x105384240>, <pelican.contents.Article object at 0x104beadd8>]"><a href="./tag/kotlin.html">Kotlin</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x105065128>, <pelican.contents.Article object at 0x104792a20>, <pelican.contents.Article object at 0x104fc1cf8>, <pelican.contents.Article object at 0x104fc1a58>, <pelican.contents.Article object at 0x10536cf98>]"><a href="./tag/androibo-ke-yue-du.html">Androi博客阅读</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x10489e4a8>]"><a href="./tag/maven.html">Maven</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x1045033c8>, <pelican.contents.Article object at 0x1045b1f98>, <pelican.contents.Article object at 0x10458c0b8>, <pelican.contents.Article object at 0x1045ccb70>, <pelican.contents.Article object at 0x104519ef0>, <pelican.contents.Article object at 0x10458cf28>, <pelican.contents.Article object at 0x1048f67f0>, <pelican.contents.Article object at 0x10485bf98>, <pelican.contents.Article object at 0x104b0b710>, <pelican.contents.Article object at 0x104856b00>, <pelican.contents.Article object at 0x104b56f28>, <pelican.contents.Article object at 0x10476f400>, <pelican.contents.Article object at 0x104889d30>, <pelican.contents.Article object at 0x1048ff550>, <pelican.contents.Article object at 0x1048dbe80>, <pelican.contents.Article object at 0x1045357f0>, <pelican.contents.Article object at 0x10484b588>, <pelican.contents.Article object at 0x1048cf198>, <pelican.contents.Article object at 0x104743c50>, <pelican.contents.Article object at 0x10473fd68>, <pelican.contents.Article object at 0x10477fd30>, <pelican.contents.Article object at 0x1045aa8d0>, <pelican.contents.Article object at 0x104728e10>, <pelican.contents.Article object at 0x104bea978>]"><a href="./tag/web.html">Web</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x104b04860>]"><a href="./tag/requirejs.html">RequireJS</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x1045033c8>, <pelican.contents.Article object at 0x1045b1f98>, <pelican.contents.Article object at 0x10458c0b8>, <pelican.contents.Article object at 0x1045ccb70>, <pelican.contents.Article object at 0x104519ef0>, <pelican.contents.Article object at 0x10458cf28>]"><a href="./tag/angular.html">Angular</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x10507a048>, <pelican.contents.Article object at 0x104d62a58>, <pelican.contents.Article object at 0x1048bfa20>, <pelican.contents.Article object at 0x10457d470>, <pelican.contents.Article object at 0x1048f9470>, <pelican.contents.Article object at 0x10471e128>, <pelican.contents.Article object at 0x10473f278>, <pelican.contents.Article object at 0x10456e7b8>, <pelican.contents.Article object at 0x1048f67f0>, <pelican.contents.Article object at 0x10485bf98>, <pelican.contents.Article object at 0x104b0b710>, <pelican.contents.Article object at 0x104856b00>, <pelican.contents.Article object at 0x104b56f28>, <pelican.contents.Article object at 0x10476f400>, <pelican.contents.Article object at 0x104889d30>, <pelican.contents.Article object at 0x1048ff550>, <pelican.contents.Article object at 0x1048dbe80>, <pelican.contents.Article object at 0x1045357f0>, <pelican.contents.Article object at 0x10484b588>, <pelican.contents.Article object at 0x1048cf198>]"><a href="./tag/java.html">Java</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x103c28d30>, <pelican.contents.Article object at 0x1045030b8>, <pelican.contents.Article object at 0x10452e710>, <pelican.contents.Article object at 0x10540f160>, <pelican.contents.Article object at 0x10486fa20>, <pelican.contents.Article object at 0x1044d3b70>, <pelican.contents.Article object at 0x105065128>, <pelican.contents.Article object at 0x104792a20>, <pelican.contents.Article object at 0x104fc1cf8>, <pelican.contents.Article object at 0x104fc1a58>, <pelican.contents.Article object at 0x10536cf98>, <pelican.contents.Article object at 0x1044d35f8>, <pelican.contents.Article object at 0x104534278>, <pelican.contents.Article object at 0x104514160>, <pelican.contents.Article object at 0x104514550>, <pelican.contents.Article object at 0x1044d0f60>, <pelican.contents.Article object at 0x103c4c198>]"><a href="./tag/android.html">Android</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x1045a5e10>, <pelican.contents.Article object at 0x104754c88>, <pelican.contents.Article object at 0x1047189e8>, <pelican.contents.Article object at 0x104805dd8>, <pelican.contents.Article object at 0x10534e0b8>, <pelican.contents.Article object at 0x10457b6a0>]"><a href="./tag/python.html">Python</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x1048c1438>, <pelican.contents.Article object at 0x10474eef0>]"><a href="./tag/yi-dong-kai-fa.html">移动开发</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x10543b048>, <pelican.contents.Article object at 0x10543b198>, <pelican.contents.Article object at 0x105023c88>, <pelican.contents.Article object at 0x105025390>, <pelican.contents.Article object at 0x104d610b8>, <pelican.contents.Article object at 0x104d617f0>, <pelican.contents.Article object at 0x1050a5208>, <pelican.contents.Article object at 0x10543ba20>, <pelican.contents.Article object at 0x10507a7f0>, <pelican.contents.Article object at 0x104b04860>, <pelican.contents.Article object at 0x104b72b00>, <pelican.contents.Article object at 0x104bee278>]"><a href="./tag/javascript.html">JavaScript</a></li>
</ul>

</div> </div><!-- /.row -->


</section>

       </div><!-- /.row -->
    </div><!-- /.container -->


       <div class="container.nopad bg">

    
        <footer id="credits" class="row">
          <div class="seven columns left-center">

                   <address id="about" class="vcard body">
                    Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                    which takes great advantage of <a href="http://python.org">Python</a>.
                    <br />
                    Based on the <a target="_blank" href="http://gumbyframework.com">Gumby Framework</a>
                    </address>
          </div>


          <div class="seven columns">
            <div class="row">
              <ul class="socbtns">





              </ul>
            </div>
          </div>
        </footer>

    </div>


  <script src="./theme/js/libs/jquery-1.9.1.min.js"></script>
  <script src="./theme/js/libs/gumby.min.js"></script>
  <script src="./theme/js/plugins.js"></script>
</body>
</html>